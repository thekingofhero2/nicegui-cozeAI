from docx import Document
from docx.shared import Inches,Cm
from docx.oxml.ns import qn
from docx.shared import Pt, RGBColor
from docx.enum.text import WD_PARAGRAPH_ALIGNMENT
import markdown as md 
from bs4 import BeautifulSoup
from typing import Union
from nicegui import ui
import time 

def MakeFile(global_text_dict):
    print(global_text_dict)
    markdown_content = global_text_dict['content']
    #markdown_content = "# 强化党领凝心力，深化金改启新程：固基引航，赋能人才，焕活投资科技新活力\n同志们：\n\n在这一年一度总结过往、展望未来的重要时刻，我们齐聚于此召开年度工作会议。过去一年，在复杂多变的市场环境和诸多挑战面前，我们砥砺前行。而今年，为推动公司实现更高质量、更可持续的发展，我们将重点聚焦六大关键工作领域，一是加强党的领导，二是巩固金融改革化险成果，三是加强战略引领，四是加速基金投资活力，五是释放金融科技实力，六是打造高素质人才队伍。接下来，我就这些方面与大家一同回顾总结、谋划部署。 \n## 一、强化党建引领，筑牢发展根基\n（一）强化思想教育，拧紧理想信念“总开关”。我们深入推进党史学习教育常态化长效化，通过组织专题培训、主题党日等活动，引导全体党员干部深刻领悟党的创新理论，从百年党史中汲取奋进力量。让广大党员干部在思想上正本清源、固本培元，坚定对马克思主义的信仰，对中国特色社会主义和共产主义的信念，增强“四个意识”、坚定“四个自信”、做到“两个维护”，以更加坚定的理想信念投入到公司发展各项工作中。\n\n（二）加强组织建设，打造坚强有力“战斗堡垒”。注重选优配强基层党组织带头人，加强党支部标准化规范化建设。建立健全党建工作责任制，明确各级党组织和党组织书记的职责，推动党建工作任务落到实处。积极开展党建品牌创建活动，鼓励各基层党组织结合自身业务特点，打造具有特色的党建品牌，以品牌建设提升党组织的凝聚力、战斗力，为公司发展提供坚强组织保障。\n\n（三）推动党建与业务融合，找准发展“动力引擎”。坚持围绕中心抓党建、抓好党建促业务，把党建工作贯穿于公司生产经营全过程。通过设立党员先锋岗、党员责任区，开展党员攻坚项目等活动，引导党员干部在项目建设、技术创新、市场开拓等重点工作中勇挑重担、冲锋在前。发挥党组织在企业决策中的参与作用，将党的领导融入公司治理各环节，以党建引领推动公司业务高质量发展。\n\n（四）抓好党风廉政建设，营造风清气正“发展环境”。严格落实党风廉政建设主体责任和监督责任，加强纪律教育和警示教育，引导党员干部自觉遵守党纪国法。持续推进作风建设，坚决整治形式主义、官僚主义，切实为基层减负。加强对重点领域和关键环节的监督，严肃查处违规违纪行为，做到有腐必反、有贪必肃，为公司健康稳定发展营造风清气正的良好环境 。 \n## 二、巩固金融改革，深化化险成效\n（一）强化制度建设，巩固改革成果。过去一年，我们积极推动金融改革制度落地，通过完善内部管理机制，规范业务流程，有效提升了金融服务的质量与效率。然而，制度的生命力在于执行，我们要进一步加强制度执行的监督与检查，确保每一项改革举措都能落到实处，形成长效机制，为金融业务的稳健发展筑牢根基。\n\n（二）优化风险管理体系，提升化险能力。面对复杂多变的金融市场环境，我们持续优化风险管理体系，加强风险识别、评估与预警能力。通过引入先进的风险监测技术和工具，实时掌握各类风险状况，做到早发现、早处置。同时，加强员工风险意识培训，提升全员应对风险的能力，将潜在风险化解在萌芽状态。\n\n（三）深化金融创新与合作，拓宽化险路径。积极探索金融创新模式，加强与各类金融机构的合作，共同开发适应市场需求的金融产品与服务。借助金融科技的力量，提升金融服务的覆盖面和精准度。通过创新业务模式，不仅能够满足客户多样化的需求，还能为化解金融风险开辟新的途径，实现金融资源的优化配置。\n\n（四）加强人才队伍建设，为改革化险提供智力支持。金融改革与化险工作的推进离不开高素质的人才队伍。我们要加大人才培养与引进力度，吸引具有丰富金融经验和创新能力的专业人才加入。同时，注重内部人才的培养与晋升，为员工提供广阔的发展空间和学习机会，打造一支业务精湛、勇于创新、敢于担当的金融人才队伍，为巩固金融改革和深化化险成效提供坚实的智力保障 。 \n## 三、加强战略引导，明晰发展方向\n（一）精准市场定位是关键。我们必须深入研究市场动态，全面分析行业趋势与竞争态势。通过市场调研、大数据分析等手段，精准找到我们产品与服务的目标客户群体，明确他们的需求痛点，以此为基础制定针对性的市场策略，使我们在激烈的市场竞争中找准立足之地，为公司发展奠定坚实基础。\n\n（二）强化创新驱动不可忽视。创新是企业发展的第一动力，在技术研发上加大投入力度，鼓励团队积极探索新技术、新方法。建立完善的创新激励机制，激发员工的创新热情，营造良好的创新氛围。同时，加强与外部科研机构、高校的合作，引进先进理念与技术，不断推动产品创新与服务升级，保持公司的领先优势。\n\n（三）优化人才战略是保障。人才是公司最宝贵的资产，我们要制定科学合理的人才吸引计划，通过有竞争力的薪酬福利、广阔的发展空间吸引行业内优秀人才加入。注重内部人才培养，搭建多元化的培训体系，为员工提供晋升通道，挖掘员工潜力。建立高效的人才评估与考核机制，确保人尽其才，为公司发展提供强有力的人才支撑。 \n\n（四）深化战略合作是助力。积极寻求与上下游企业、相关领域的龙头企业开展战略合作，整合各方资源，实现优势互补。通过战略合作，拓展业务渠道，共同开拓市场，降低运营成本。加强合作过程中的沟通与协调，建立稳定的合作关系，实现互利共赢，推动公司在更广阔的市场中稳健发展。  \n## 四、激发基金活力，增强投资动力\n（一）优化基金管理机制是关键。我们要全面梳理现有的基金管理流程，去除繁琐冗余的环节，建立更加高效、灵活的决策机制。简化基金审批流程，缩短资金投放周期，确保项目能够及时获得资金支持，让基金能够迅速响应市场变化，在各类优质项目中精准布局，从而有效激发基金活力。\n\n（二）加强人才队伍建设不容忽视。专业的投资人才是增强投资动力的核心力量。我们需要加大人才引进力度，吸引具有丰富行业经验、敏锐市场洞察力的投资专家加入我们的团队。同时，注重内部人才培养，通过组织培训、研讨会等多种形式，提升团队成员的专业素养和投资分析能力，打造一支高素质、专业化的投资人才队伍。\n\n（三）拓展多元化投资渠道是重要途径。我们不能局限于现有的投资领域和方式，要积极探索新兴产业的投资机会，如人工智能、新能源、生物医药等领域，这些领域具有巨大的发展潜力和创新活力。此外，加强与外部投资机构的合作，开展联合投资、产业基金等多种合作模式，整合各方资源，拓宽投资渠道，为基金寻找更多优质投资项目。\n\n（四）强化风险管理体系必不可少。在积极投资的过程中，必须高度重视风险防控。建立完善的风险评估机制，对投资项目进行全面、深入的风险分析，提前制定应对策略。加强对投资项目的全程跟踪管理，及时发现并解决潜在风险问题，确保基金资产的安全，为持续增强投资动力提供坚实保障 。  \n## 五、释放科技潜能，赋能金融创新\n（一）我们要大力推动数字化转型，以科技之力重塑金融服务流程。利用大数据、人工智能等先进技术，对客户需求进行精准画像，优化信贷审批流程，提高服务效率和质量，让金融服务更便捷、更智能，打破传统金融服务的时间与空间限制，为客户提供全方位、全时段的优质体验。\n\n（二）积极强化科技创新投入，建立完善的金融科技研发体系。加大对前沿技术研究的资金支持，吸引顶尖科技人才加入，组建高素质的研发团队。通过自主研发与合作创新相结合的方式，开发具有竞争力的金融科技产品，不断拓展金融服务的边界，为金融创新奠定坚实的技术基础。\n\n（三）加强跨行业合作与协同创新，拓展金融创新的广阔空间。与科技企业、互联网平台等建立深度合作关系，整合各方资源优势，共同探索新的金融业务模式和产品。比如开展供应链金融创新，借助科技手段实现对产业链上下游企业的资金流、信息流的有效整合，为实体经济提供更有力的金融支持。 \n\n（四）高度重视数据安全与风险管理，确保金融创新在稳健轨道上前行。随着科技在金融领域的广泛应用，数据安全和风险防控愈发重要。我们要建立健全数据安全管理体系，运用先进的加密技术和安全防护机制，保障客户信息和资金安全。同时，利用科技手段加强风险监测和预警，及时发现并化解潜在风险，让金融创新既充满活力又安全可靠。  \n## 六、打造人才方阵，厚植发展优势\n（一）强化人才引进力度是打造人才方阵的关键前提。我们要拓宽人才引进渠道，不仅要聚焦传统的校园招聘，从各大高校吸纳优秀的应届毕业生，为企业注入新鲜血液；还要积极参与各类高端人才招聘会，精准对接行业内的资深专家和技术骨干，将外部的先进理念和技术引入企业。同时，建立完善的人才引进激励机制，对于符合企业发展战略需求的关键人才，提供具有竞争力的薪酬待遇、良好的工作环境以及广阔的发展空间，吸引他们加入我们的团队，为厚植发展优势奠定坚实基础。\n\n（二）注重人才培养体系建设是打造人才方阵的核心环节。我们要构建多层次、多样化的培训体系，针对不同岗位、不同层级的员工制定个性化的培训方案。对于新入职员工，开展入职培训，帮助他们快速了解企业文化、熟悉工作流程；对于有一定工作经验的员工，提供专业技能提升培训，助力他们在专业领域不断深耕；对于管理人才，组织领导力培训，培养他们的战略思维和团队管理能力。此外，鼓励员工自主学习，设立学习奖励基金，支持员工参加各类行业研讨会、学术交流活动等，不断提升员工的综合素质，厚植企业发展的人才优势。\n\n（三）完善人才评价与激励机制是打造人才方阵的重要保障。建立科学合理的人才评价体系，从工作业绩、专业能力、团队协作等多个维度对员工进行全面评价，确保评价结果公平公正。依据评价结果，实施差异化的激励措施，对于表现优秀的员工，给予物质奖励，如奖金、股权等，同时提供晋升机会，让他们能够在合适的岗位上发挥更大的价值。对于暂时表现不佳的员工，及时进行辅导和帮助，给予他们改进的机会。通过这样的机制，充分调动员工的工作积极性和创造性，激发人才活力，推动企业持续发展。\n\n（四）营造良好的人才发展生态是打造人才方阵的重要基础。我们要努力营造积极向上、团结协作的企业文化氛围，倡导开放包容的工作环境，让员工感受到企业的关怀和尊重。加强企业内部的沟通与交流，搭建员工交流平台，促进不同部门之间的信息共享和协同合作。关注员工的职业发展规划，为员工提供清晰的职业晋升路径，让他们在企业中能够看到自己的未来。同时，关心员工的生活需求，解决他们的后顾之忧，使员工能够全身心地投入到工作中，为厚植发展优势营造良好的人才生态环境。"
    md_doc = md.markdown(markdown_content)
    print(md_doc)
    soup = BeautifulSoup(md_doc,"html.parser")
    document = Document()
    document.styles['Normal'].font.name = u'仿宋'
    document.styles['Normal']._element.rPr.rFonts.set(qn('w:eastAsia'), u'仿宋')
    document.styles['Normal'].font.size = Pt(16)
    document.styles['Normal'].font.color.rgb = RGBColor(0, 0, 0)
    document.top_margin = Cm(3.75)
    document.bottom_margin = Cm(3.5)
    document.left_margin = Cm(2.7)
    document.right_margin = Cm(2.6)
    for element in soup:
        if element.name == 'h1':
            p1 = document.add_paragraph()
            text1 = p1.add_run(element.text+"""
    """)
            text1.font.size = Pt(22)
            text1.bold = True
            text1.font.name = '方正小标简宋'
            text1.element.rPr.rFonts.set(qn('w:eastAsia'), '方正小标简宋')
            p1.alignment = WD_PARAGRAPH_ALIGNMENT.CENTER
            #document.add_heading(element.text, 0)
        elif element.name == 'h2':
            p = document.add_paragraph()
            text1 = p.add_run(element.text)
            text1.font.size = Pt(16)
            text1.bold = True
            text1.font.name = '黑体'
            text1.element.rPr.rFonts.set(qn('w:eastAsia'), '黑体')
            p.alignment = WD_PARAGRAPH_ALIGNMENT.LEFT
        elif element.name == 'h3':
            p = document.add_paragraph()
            text1 = p.add_run("    "+element.text)
            text1.font.size = Pt(16)
            text1.bold = True
            text1.font.name = '楷体'
            text1.element.rPr.rFonts.set(qn('w:eastAsia'), '楷体')
            p.alignment = WD_PARAGRAPH_ALIGNMENT.LEFT
        elif element.name == 'p':
            p = document.add_paragraph()
            if element.text.endswith("："):
                text1 = p.add_run(element.text)
            else:
                text1 = p.add_run("    "+element.text)
    #行间距
    for paragraph in document.paragraphs:
        paragraph.paragraph_format.line_spacing = Pt(28)      
    # from io import StringIO
    # target_stream = StringIO()
    #document.save(target_stream)

    filename = f"{time.time()}.docx"
    document.save(filename)
    ui.download(src=filename,filename="aaab.docx")
#ui.run(port=1111)